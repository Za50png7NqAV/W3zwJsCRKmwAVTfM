const burger=document.getElementById("burger"),menu=document.getElementById("menu"),overlay=document.getElementById("overlay"),searchToggle=document.getElementById("searchToggle"),searchBlock=document.getElementById("searchBlock"),searchCancel=document.getElementById("searchCancel");burger.addEventListener("click",()=>{menu.classList.add("is-active"),overlay.classList.add("is-active")}),overlay.addEventListener("click",()=>{menu.classList.remove("is-active"),overlay.classList.remove("is-active")}),document.querySelectorAll(".menu-link").forEach(e=>{e.addEventListener("click",()=>{menu.classList.remove("is-active"),overlay.classList.remove("is-active")})}),searchToggle.addEventListener("click",()=>{searchBlock.classList.add("is-active")}),searchCancel.addEventListener("click",()=>{searchBlock.classList.remove("is-active")}),document.addEventListener("DOMContentLoaded",function(){const n=document.getElementById("search-query"),s=document.getElementById("search-results"),o=document.getElementById("search-iframe");let e,i;fetch("/index.json").then(e=>e.json()).then(t=>{i=t,e=lunr(function(){this.ref("permalink"),this.field("title"),this.field("content"),t.forEach(e=>this.add(e))})}).catch(e=>console.error("Error loading index:",e)),n.addEventListener("input",function(){c(this.value)}),window.handleSearch=function(t){t&&t.preventDefault();const s=n.value.trim();if(!s||s.length<2)return;const o=e.search(s);r(o,s),l(s);const i=`#gsc.tab=0&gsc.sort=&gsc.q=${encodeURIComponent(s)}`;window.location.hash=i};function a(e,t){const n=new RegExp(`(${t})`,"gi");return e.replace(n,`<mark>$1</mark>`)}function r(e,t){if(s.innerHTML="",e.length===0){o.style.display="block";return}o.style.display="none",e.forEach(e=>{const n=i.find(t=>t.permalink===e.ref),r=a(n.title,t),c=n.content.substring(0,80),l=a(c,t),o=document.createElement("div");o.innerHTML=`
          <h3><a href="${n.permalink}">${r}</a></h3>
          <p>${l}...</p>`,s.appendChild(o)})}function c(t){if(!e||t.length<2){s.innerHTML="",o.style.display="none";return}const n=e.search(t);r(n,t)}function l(e){let n=JSON.parse(localStorage.getItem("searchHistory"))||[];n.includes(e)||(n.unshift(e),n.length>10&&(n=n.slice(0,10)),localStorage.setItem("searchHistory",JSON.stringify(n))),t()}function t(){const o=JSON.parse(localStorage.getItem("searchHistory"))||[],s=document.getElementById("recent-searches");if(s.innerHTML="",o.length===0)return;const i=document.createElement("h4");i.textContent="Recent Searches",i.style.marginBottom="5px",s.appendChild(i);const e=document.createElement("button");e.textContent="🗑️Clear  ",e.style.marginBottom="10px",e.style.padding="5px 3px",e.style.backgroundColor="#e74c3c",e.style.color="#fff",e.style.border="none",e.style.borderRadius="5px",e.style.cursor="pointer",e.onclick=()=>{localStorage.removeItem("searchHistory"),t()},s.appendChild(e),o.forEach(e=>{const i=document.createElement("div");i.style.display="inline-flex",i.style.alignItems="center",i.style.margin="5px",i.style.border="1px solid #ccc",i.style.borderRadius="5px",i.style.overflow="hidden",i.style.backgroundColor="#f9f9f9";const c=document.createElement("span");c.innerHTML='<i class="bx bx-search"></i>',c.style.padding="2px 3px",c.style.backgroundColor="#e0e0e0",c.style.borderRight="1px solid #ccc";const a=document.createElement("button");a.textContent=e,a.style.padding="3px 5px",a.style.border="none",a.style.background="none",a.style.cursor="pointer",a.style.fontSize="14px",a.onclick=()=>{n.value=e,handleSearch()};const r=document.createElement("button");r.textContent="✕",r.style.padding="3px 5px",r.style.border="none",r.style.backgroundColor="#ffe6e6",r.style.cursor="pointer",r.title="Remove",r.onclick=()=>{const n=o.filter(t=>t!==e);localStorage.setItem("searchHistory",JSON.stringify(n)),t()},i.appendChild(c),i.appendChild(a),i.appendChild(r),s.appendChild(i)})}t()});const searchInput2=document.getElementById("search-query"),clearInputBtn=document.getElementById("clearInputBtn");searchInput2.addEventListener("input",()=>{clearInputBtn.style.display=searchInput2.value.length>0?"block":"none"}),clearInputBtn.addEventListener("click",()=>{searchInput2.value="",clearInputBtn.style.display="none",searchInput.focus(),document.getElementById("search-results").innerHTML="",document.getElementById("search-iframe").style.display="none"})